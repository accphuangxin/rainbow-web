<!DOCTYPE html>
<html>
<head>
<meta>
    <title>Rainbow</title>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<meta http-equiv="Cache-Control" content="no-store" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
    
    <link href="static/adminlte/bootstrap/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="static/adminlte/bootstrap/css/bootstrap-switch.min.css" rel="stylesheet" type="text/css" />
    
    <link href="resources/font-awesome-4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    
    <link href="resources/ionicons/css/ionicons.min.css" rel="stylesheet" type="text/css" />
    
    <link href="static/adminlte/dist/css/AdminLTE.css" rel="stylesheet" type="text/css" />
    <link href="static/adminlte/dist/css/skins/_all-skins.css" rel="stylesheet" type="text/css" />
    
    <link href="static/mmgrid/css/mmGrid.css" rel="stylesheet" type="text/css"/>
    <link href="static/mmgrid/css/mmPaginator.css" rel="stylesheet" type="text/css"/>
    <link href="static/mmgrid/css/mmGrid-bootstrap.css" rel="stylesheet" type="text/css"/>
    <link href="static/mmgrid/css/mmPaginator-bootstrap.css" rel="stylesheet" type="text/css"/>
    
    <!-- ztree css库-->
    <link rel="stylesheet" href="resources/zTree/css/demo.css" type="text/css">
	<link rel="stylesheet" href="resources/zTree/css/zTreeStyle/zTreeStyle.css" type="text/css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
	<script type="text/javascript" src="static/adminlte/plugins/jQuery/jQuery-2.1.4.min.js"></script>
	<!-- 菜单库 -->
	<script type="text/javascript" src="resources/menu/MenuWeaver.js"></script>
	<!-- 基础css表 -->
	<link rel="stylesheet" type="text/css" href="resources/css/base.css">
</head>

<body id="mybody" class="skin-blue sidebar-mini">
	<div class="wrapper">
		<header class="main-header">
      <!-- Logo -->
      <a href="index2.html" class="logo">
        <!-- mini logo for sidebar mini 50x50 pixels -->
        <span class="logo-mini" style="font-weight: 100">Rainbow</span>
        <!-- logo for regular state and mobile devices -->
        <span class="logo-lg" style="font-weight: 100;font-size: 30px;">Rainbow</span>
      </a>

      <!-- Header Navbar: style can be found in header.less -->
      <nav class="navbar navbar-static-top" role="navigation">
        <!-- Sidebar toggle button-->
        <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
          <span class="sr-only">Toggle navigation</span>
        </a>
        <!-- Navbar Right Menu -->
        <div class="navbar-custom-menu">
          <ul class="nav navbar-nav">
              <li class="dropdown user user-menu">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <img src="static/adminlte/dist/img/user2-160x160.jpg" class="user-image" alt="User Image"/>
                <span id="userName" class="hidden-xs"></span>
              </a>
              <ul class="dropdown-menu">
                <!-- User image -->
                <li class="user-header">
                  <img src="static/adminlte/dist/img/user2-160x160.jpg" class="img-circle" alt="User Image" />
                  <p>
                   <span id="userInfo"></span>
                  <small>Rainbow</small>
                  </p>
                </li>
                
                <li class="user-footer">
                  <!-- 
                  <div style="text-align: center;">
                    <a href="javascript:sys_logout();" class="btn btn-default btn-flat">安全退出</a>
                  </div>
                   -->
                </li>
              </ul>
            </li>
          </ul>
        </div>

      </nav>
    </header>
   <aside class="main-sidebar">
      <!-- sidebar: style can be found in sidebar.less -->
      <section class="sidebar">
        <!-- Sidebar user panel -->
        <!-- sidebar menu: : style can be found in sidebar.less -->
        <ul id="menuContainer" class="sidebar-menu">
          <li class="header">导航菜单</li>
        </ul>
      </section>
      <!-- /.sidebar -->
    </aside>
    
    <div class="content-wrapper">
      
    </div>
    	
    	
    	<script type="text/javascript">
    	 var n = self.location.href.indexOf("?")//查看是否包含参数
    	 var url_param = "";
    	  if(n>0)//存在参数 
    	  {
    		  var para = self.location.href.substr(n+1);
    		  var url_array = para.split("&");
    		  if(url_array.length > 1){
	    		  url_param = url_array[1];
    		  }
	    	  document.cookie = url_array[0];
    	  }
    	  
    	//显示loading
    	$.ajax({
	                url : './dispatcherAction/query.do?service=menuService&method=queryMenusNew&'+url_param,
	                cache : false, 
	                async : false,
	                data : {},
	                type : "POST",
	                dataType : 'json',
	                success : function (result){
	                	/* result={"rows":[{"id":"1","parentCode":"","text":"一级菜单","state":"folder","url":"url"}
	                		,{"id":"2","parentCode":"1","text":"二级菜单","state":"folder","url":"url"}
	                		,{"id":"3","parentCode":"2","text":"三级页面","state":"item","url":"http://www.baidu.com"}
	                		,{"id":"4","parentCode":"1","text":"二级页面","state":"item","url":"http://abc.com"}]}; */
	                	var w = new MenuWeaver("menuContainer",result);
	                	w.weaver();            	
	                },
	                fail : function(){
	                	alert("获取菜单数据时候异常!");
	                }
	            });
    	
    	//取消loading
    	</script>
	<footer class="main-footer">
     <div class="pull-right hidden-xs">
       <b>Version</b> 2.0
     </div>
     <strong>Copyright©howbuy.com &copy;<a href="http://www.howbuy.com">inc2015</a>.</strong> All rights reserved.ICP备08003295号
    </footer>
	</div>
	
    <script type="text/javascript" src="static/adminlte/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/adminlte/bootstrap/js/bootstrap-switch.min.js"></script>
    <script type="text/javascript" src='static/adminlte/plugins/fastclick/fastclick.min.js'></script>
    <script type="text/javascript" src="static/adminlte/dist/js/app.min.js"></script> 
    <script type="text/javascript" src="static/adminlte/plugins/sparkline/jquery.sparkline.min.js"></script>
    <script type="text/javascript" src="static/adminlte/plugins/slimScroll/jquery.slimscroll.min.js"></script>
    <script type="text/javascript" src="static/jquery-resize/jquery.ba-resize.js"></script>
    
    
    <script type="text/javascript" src="static/mmgrid/mmGrid.js"></script>
    <script type="text/javascript" src="static/mmgrid/mmPaginator.js"></script>
    
    <script type="text/javascript" src="resources/js/json2.min.js"></script>
    <script type="text/javascript" src="resources/js/rainbow.js"></script>
    <script type="text/javascript" src="resources/js/rainbowAjax.js"></script>
    
    <!-- 校验库 @LeoChan-->
      <script type="text/javascript" src="resources/js/common-form.js"></script>
      <script type="text/javascript" src="resources/validation/validation.js"></script>
			 
	
	<!-- ztree实现库 @LeoChan-->
	<script type="text/javascript" src="resources//zTree/js/jquery.ztree.core-3.5.js"></script>
	<script type="text/javascript" src="resources//zTree/js/jquery.ztree.excheck-3.5.js"></script>
	<script type="text/javascript" src="resources//zTree/TreeSelectorWeaver.js"></script>
	<!-- common select @LeoChan -->
    <script type="text/javascript" src="resources/select/CommonSelectWeaver.js"></script>
    <script type="text/javascript" src="resources/My97DatePicker/WdatePicker.js"></script>
    
    <script type="text/javascript">
    
        setInterval('clearStyle();',1000);
	    function clearStyle(){
	   	 $("#mybody").attr("style","");
	    }
	    function sys_logout(){
     	   var rainbow = new Rainbow();
     	   rainbowAjax.url("./loginAction/logout.do", rainbow, new logout_Callback());
	    }
	    
	     //ajax回调处理
	     var logout_Callback = function(){
	     		this.onSuccess=function(data){
	     			try {
	     				var j_obj = data;
	     				if (j_obj.success) {
	     					window.location = "login.html";
	     				}else{
	     					$('#msg').html(data.msg);
	     				}
	     			} catch (e) {
	     				alert("异常!")
	     			}
	     		};
	     		this.onFail = function(jqXHR, textStatus, errorThrown){
	     		
	     		};
	     };
	     
	     $.ajax({
	 	        url : './dispatcherAction/query.do?service=ldapService&method=getUserInfo',
	 	        cache : false, 
	 	        async : false,
	 	        type : "POST",
	 	        dataType : 'json',
	 	        success : function (data){
	 	        	var result = data.rows[0];
	 	        	$("#userName").html(result.userName);
	 	        	$("#userInfo").html(result.userName);
	 	        },
	 	        fail : function(){
	 	        }
	 	    }); 
    </script>
</body>
</html>